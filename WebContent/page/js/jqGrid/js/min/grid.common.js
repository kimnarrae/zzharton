(function(c){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jqdnr","./jqmodal"],c):"object"===typeof exports?c(require("jquery")):c(jQuery)})(function(c){var n=c.jgrid,w=c.fn.jqGrid,p=w.getGuiStyles,x=w.getGridRes;n.jqModal=n.jqModal||{};c.extend(!0,n.jqModal,{toTop:!0});c.extend(n,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},hideModal:function(a,b){b=c.extend({jqm:!0,gb:"",removemodal:!1},b||{});var d=
b.gb&&"string"===typeof b.gb&&"#gbox_"===b.gb.substr(0,6)?c("#"+b.gb.substr(6))[0]:!1,k=c(a);if(b.onClose&&(d=d?b.onClose.call(d,a):b.onClose(a),"boolean"===typeof d&&!d))return;if(c.fn.jqm&&!0===b.jqm)k.attr("aria-hidden","true").jqmHide();else{if(""!==b.gb)try{c(">.jqgrid-overlay",b.gb).first().hide()}catch(l){}k.hide().attr("aria-hidden","true")}b.removemodal&&k.remove()},findPos:function(a){var b=0,d=0;if(a.offsetParent){do b+=a.offsetLeft,d+=a.offsetTop,a=a.offsetParent;while(a)}return[b,d]},
createModal:function(a,b,d,k,l,h,e){var g=n.jqID,f=this.p,f=null!=f?f.jqModal||{}:{};d=c.extend(!0,{resizingRightBottomIcon:w.getIconRes.call(this,"form.resizableLtr")},n.jqModal||{},f,d);var f=document.createElement("div"),m="#"+g(a.themodal),r="rtl"===c(d.gbox).attr("dir")?!0:!1,u=a.resizeAlso?"#"+g(a.resizeAlso):!1;e=c.extend({},e||{});f.className=p.call(this,"dialog.window","ui-jqdialog");f.id=a.themodal;f.dir=r?"rtl":"ltr";var q=document.createElement("div");q.className=p.call(this,"dialog.document");
c(q).attr("role","document");var y=document.createElement("div");y.className=p.call(this,"dialog.subdocument");q.appendChild(y);f.appendChild(q);q=document.createElement("div");q.className=p.call(this,"dialog.header","ui-jqdialog-titlebar "+(r?"ui-jqdialog-titlebar-rtl":"ui-jqdialog-titlebar-ltr"));q.id=a.modalhead;c(q).append("<span class='ui-jqdialog-title'>"+d.caption+"</span>");var v=p.call(this,"states.hover"),t=c("<a aria-label='Close' class='"+p.call(this,"dialog.closeButton","ui-jqdialog-titlebar-close")+
"'></a>").hover(function(){t.addClass(v)},function(){t.removeClass(v)}).append("<span class='"+w.getIconRes.call(this,"form.close")+"'></span>");c(q).append(t);r=document.createElement("div");c(r).addClass(p.call(this,"dialog.content","ui-jqdialog-content")).attr("id",a.modalcontent);c(r).append(b);y.appendChild(r);c(y).prepend(q);!0===h?c("body").append(f):"string"===typeof h?c(h).append(f):c(f).insertBefore(k);c(f).css(e);void 0===d.jqModal&&(d.jqModal=!0);b={};if(c.fn.jqm&&!0===d.jqModal)0===d.left&&
0===d.top&&d.overlay&&(h=[],h=n.findPos(l),d.left=h[0]+4,d.top=h[1]+4),b.top=d.top+"px",b.left=d.left;else if(0!==d.left||0!==d.top)b.left=d.left,b.top=d.top+"px";c("a.ui-jqdialog-titlebar-close",q).click(function(){var a=c(m).data("onClose")||d.onClose,b=c(m).data("gbox")||d.gbox;n.hideModal(m,{gb:b,jqm:d.jqModal,onClose:a,removemodal:d.removemodal||!1});return!1});0!==d.width&&d.width||(d.width=300);0!==d.height&&d.height||(d.height=200);d.zIndex||((k=c(k).parents("*[role=dialog]").first().css("z-index"))?
(d.zIndex=parseInt(k,10)+2,d.toTop=!0):d.zIndex=950);b.left&&(b.left+="px");c(f).css(c.extend({width:isNaN(d.width)?"auto":d.width+"px",height:isNaN(d.height)?"auto":d.height+"px",zIndex:d.zIndex},b)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":a.modalhead,"aria-hidden":"true"});void 0===d.drag&&(d.drag=!0);void 0===d.resize&&(d.resize=!0);if(d.drag)if(c.fn.jqDrag)c(q).css("cursor","move"),c(f).jqDrag(q);else try{c(f).draggable({handle:c("#"+g(q.id))})}catch(z){}if(d.resize)if(c.fn.jqResize)c(r).append("<div class='jqResize ui-resizable-handle ui-resizable-se "+
d.resizingRightBottomIcon+"'></div>"),c(m).jqResize(".jqResize",u);else try{c(f).resizable({handles:"se, sw",alsoResize:u})}catch(z){}!0===d.closeOnEscape&&c(f).keydown(function(a){27===a.which&&(a=c(m).data("onClose")||d.onClose,n.hideModal(m,{gb:d.gbox,jqm:d.jqModal,onClose:a,removemodal:d.removemodal||!1,formprop:!d.recreateForm||!1,form:d.form||""}))})},viewModal:function(a,b){b=c.extend(!0,{overlay:30,modal:!1,overlayClass:p.call(this,"overlay"),onShow:n.showModal,onHide:n.closeModal,gbox:"",
jqm:!0,jqM:!0},n.jqModal||{},b||{});if(c.fn.jqm&&!0===b.jqm)b.jqM?c(a).attr("aria-hidden","false").jqm(b).jqmShow():c(a).attr("aria-hidden","false").jqmShow();else{""!==b.gbox&&(c(">.jqgrid-overlay",b.gbox).first().show(),c(a).data("gbox",b.gbox));c(a).show().attr("aria-hidden","false");try{c(":input:visible",a)[0].focus()}catch(d){}}},info_dialog:function(a,b,d,k){var l=this,h=l.p,e=c.extend(!0,{width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1E3,jqModal:!0,modal:!1,
closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]},n.jqModal||{},null!=h?h.jqModal||{}:{},{caption:"<b>"+a+"</b>"},k||{}),g=e.jqModal;c.fn.jqm&&!g&&(g=!1);a="";var f=p.call(l,"states.hover");if(0<e.buttons.length)for(k=0;k<e.buttons.length;k++)void 0===e.buttons[k].id&&(e.buttons[k].id="info_button_"+k),a+=n.builderFmButon.call(l,e.buttons[k].id,e.buttons[k].text);b="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+
(isNaN(e.dataheight)?e.dataheight:e.dataheight+"px")+";"+("text-align:"+e.align+";")+"'>"+b+"</div>");if(d||""!==a)b+="<hr class='"+p.call(l,"dialog.hr")+"' style='margin:1px'/><div style='text-align:"+e.buttonalign+";padding:.8em 0 .5em 0;background-image:none;border-width: 1px 0 0 0;'>"+(d?n.builderFmButon.call(l,"closedialog",d):"")+a+"</div>";b+="</div>";try{"false"===c("#info_dialog").attr("aria-hidden")&&n.hideModal("#info_dialog",{jqm:g}),c("#info_dialog").remove()}catch(m){}n.createModal.call(l,
{themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",resizeAlso:"infocnt"},b,e,"","",!0);a&&c.each(e.buttons,function(a){c("#"+n.jqID(l.id),"#info_id").on("click",function(){e.buttons[a].onClick.call(c("#info_dialog"));return!1})});c("#closedialog","#info_id").click(function(){n.hideModal("#info_dialog",{jqm:g,onClose:c("#info_dialog").data("onClose")||e.onClose,gb:c("#info_dialog").data("gbox")||e.gbox});return!1});c(".fm-button","#info_dialog").hover(function(){c(this).addClass(f)},
function(){c(this).removeClass(f)});c.isFunction(e.beforeOpen)&&e.beforeOpen();n.viewModal.call(l,"#info_dialog",{onHide:function(a){a.w.hide().remove();a.o&&a.o.remove()},modal:e.modal,jqm:g});c.isFunction(e.afterOpen)&&e.afterOpen();try{c("#info_dialog").focus()}catch(m){}},bindEv:function(a,b){c.isFunction(b.dataInit)&&b.dataInit.call(this,a,b);b.dataEvents&&c.each(b.dataEvents,function(){if(void 0!==this.data)c(a).on(this.type,this.data,this.fn);else c(a).on(this.type,this.fn)})},createEl:function(a,
b,d,k,l){function h(a,d,b){var e="dataInit dataEvents dataUrl buildSelect sopt searchhidden defaultValue attr custom_element custom_value selectFilled rowId mode cm iCol".split(" ");void 0!==b&&c.isArray(b)&&c.merge(e,b);c.each(d,function(b,d){-1===c.inArray(b,e)&&c(a).attr(b,d)});d.hasOwnProperty("id")||c(a).attr("id",n.randId())}var e="",g=this,f=g.p,m=n.info_dialog,r=x.call(c(g),"errors.errcap"),u=x.call(c(g),"edit"),q=u.msg,u=u.bClose;if(null==b)return"";switch(a){case "textarea":e=document.createElement("textarea");
k?b.cols||c(e).css({width:"100%","box-sizing":"border-box"}):b.cols||(b.cols=19);b.rows||(b.rows=2);if("&nbsp;"===d||"&#160;"===d||1===d.length&&160===d.charCodeAt(0))d="";e.value=d;h(e,b);c(e).attr({role:"textbox"});break;case "checkbox":e=document.createElement("input");e.type="checkbox";b.value?(l=b.value.split(":"),d===l[0]&&(e.checked=!0,e.defaultChecked=!0),e.value=l[0],c(e).data("offval",l[1])):(l=String(d).toLowerCase(),0>l.search(/(false|f|0|no|n|off|undefined)/i)&&""!==l?(e.checked=!0,e.defaultChecked=
!0,e.value=d):e.value="on",c(e).data("offval","off"));h(e,b,["value"]);c(e).attr({role:"checkbox","aria-checked":e.checked?"true":"false"});break;case "select":e=document.createElement("select");m=[];a=null;!0===b.multiple?(k=!0,e.multiple="multiple",c(e).attr("aria-multiselectable","true"),m=d.split(","),m=c.map(m,function(a){return c.trim(a)})):(k=!1,m[0]=c.trim(d));void 0===b.size&&(b.size=k?3:1);try{a=b.rowId}catch(t){}f&&f.idPrefix&&(a=n.stripPref(f.idPrefix,a));if(void 0!==b.dataUrl){var p=
b.postData||l.postData,f={elem:e,options:b,cm:b.cm,mode:b.mode,rowid:a,iCol:b.iCol,ovm:m};c.ajax(c.extend({url:c.isFunction(b.dataUrl)?b.dataUrl.call(g,a,d,String(b.name),f):b.dataUrl,type:"GET",dataType:"html",data:c.isFunction(p)?p.call(g,a,d,String(b.name)):p,context:f,success:function(a,b,d){var e=this.ovm,k=this.elem,f=this.cm,l=this.iCol,m=c.extend({},this.options),q=this.rowid,r=this.mode;a=c.isFunction(m.buildSelect)?m.buildSelect.call(g,a,d,f,l):a;"string"===typeof a&&(a=c(c.trim(a)).html());
a&&(c(k).append(a),h(k,m,p?["postData"]:void 0),setTimeout(function(){var a;c("option",k).each(function(b){0===b&&k.multiple&&(this.selected=!1);-1<c.inArray(c.trim(c(this).val()),e)&&(a=this.selected=!0)});a||c("option",k).each(function(){-1<c.inArray(c.trim(c(this).text()),e)&&(this.selected=!0)});n.fullBoolFeedback.call(g,m.selectFilled,"jqGridSelectFilled",{elem:k,options:m,cm:f,rowid:q,mode:r,cmName:null!=f?f.name:m.name,iCol:l})},0))}},l||{}))}else b.value&&(n.fillSelectOptions(e,b.value,void 0===
b.separator?":":b.separator,void 0===b.delimiter?";":b.delimiter,k,d),h(e,b,["value"]),n.fullBoolFeedback.call(g,b.selectFilled,"jqGridSelectFilled",{elem:e,options:b,cm:b.cm,rowid:a,mode:b.mode,cmName:null!=b.cm?b.cm.name:b.name,iCol:b.iCol}));break;case "text":case "password":case "button":l="button"===a?"button":"textbox";e=document.createElement("input");e.type=a;h(e,b);e.value=d;"button"!==a&&(k?b.size||c(e).css({width:"100%","box-sizing":"border-box"}):b.size||(b.size=20));c(e).attr("role",
l);break;case "image":case "file":e=document.createElement("input");e.type=a;h(e,b);break;case "custom":e=document.createElement("span");try{if(c.isFunction(b.custom_element)){var v=b.custom_element.call(g,d,b);if(v instanceof jQuery||n.isHTMLElement(v)||"string"===typeof v)v=c(v).addClass("customelement").attr({id:b.id,name:b.name}),c(e).empty().append(v);else throw"editoptions.custom_element returns value of a wrong type";}else throw"editoptions.custom_element is not a function";}catch(t){"e1"===
t&&m.call(g,r,"function 'custom_element' "+q.nodefined,u),"e2"===t?m.call(g,r,"function 'custom_element' "+q.novalue,u):m.call(g,r,"string"===typeof t?t:t.message,u)}}return e},checkDate:function(a,b){var d={},c;a=a.toLowerCase();c=-1!==a.indexOf("/")?"/":-1!==a.indexOf("-")?"-":-1!==a.indexOf(".")?".":"/";a=a.split(c);b=b.split(c);if(3!==b.length)return!1;var l=-1,h,e=c=-1,g;for(g=0;g<a.length;g++)h=isNaN(b[g])?0:parseInt(b[g],10),d[a[g]]=h,h=a[g],-1!==h.indexOf("y")&&(l=g),-1!==h.indexOf("m")&&
(e=g),-1!==h.indexOf("d")&&(c=g);h="y"===a[l]||"yyyy"===a[l]?4:"yy"===a[l]?2:-1;var f;g=[0,31,29,31,30,31,30,31,31,30,31,30,31];if(-1===l)return!1;f=d[a[l]].toString();2===h&&1===f.length&&(h=1);if(f.length!==h||0===d[a[l]]&&"00"!==b[l]||-1===e)return!1;f=d[a[e]].toString();if(1>f.length||1>d[a[e]]||12<d[a[e]]||-1===c)return!1;f=d[a[c]].toString();!(h=1>f.length||1>d[a[c]]||31<d[a[c]])&&(h=2===d[a[e]])&&(l=d[a[l]],h=d[a[c]]>(0!==l%4||0===l%100&&0!==l%400?28:29));return h||d[a[c]]>g[d[a[e]]]?!1:!0},
isEmpty:function(a){return a.match(/^\s+$/)||""===a?!0:!1},checkTime:function(a){var b=/^(\d{1,2}):(\d{2})([apAP][Mm])?$/;if(!n.isEmpty(a))if(a=a.match(b)){if(a[3]){if(1>a[1]||12<a[1])return!1}else if(23<a[1])return!1;if(59<a[2])return!1}else return!1;return!0},checkValues:function(a,b,d,k,l){var h,e,g=this.p;e=g.colModel;var f=n.isEmpty,m=x.call(c(this),"edit.msg"),r=x.call(c(this),"formatter.date.masks");if(void 0===d){"string"===typeof b&&(b=g.iColByName[b]);if(void 0===b||0>b)return[!0,"",""];
k=e[b];d=k.editrules;null!=k.formoptions&&(h=k.formoptions.label)}else h=void 0===k?"_":k,k=e[b];if(d){h||(h=null!=g.colNames?g.colNames[b]:k.label);if(!0===d.required&&f(a))return[!1,h+": "+m.required,""];g=!1===d.required?!1:!0;if(!0===d.number&&(!1!==g||!f(a))&&isNaN(a))return[!1,h+": "+m.number,""];if(void 0!==d.minValue&&!isNaN(d.minValue)&&parseFloat(a)<parseFloat(d.minValue))return[!1,h+": "+m.minValue+" "+d.minValue,""];if(void 0!==d.maxValue&&!isNaN(d.maxValue)&&parseFloat(a)>parseFloat(d.maxValue))return[!1,
h+": "+m.maxValue+" "+d.maxValue,""];var p;if(!(!0!==d.email||!1===g&&f(a)||(p=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
p.test(a))))return[!1,h+": "+m.email,""];if(!(!0!==d.integer||!1===g&&f(a)||!isNaN(a)&&0===a%1&&-1===a.indexOf(".")))return[!1,h+": "+m.integer,""];if(!(!0!==d.date||!1===g&&f(a)||(k.formatoptions&&k.formatoptions.newformat?(e=k.formatoptions.newformat,r.hasOwnProperty(e)&&(e=r[e])):e=e[b].datefmt||"Y-m-d",n.checkDate(e,a))))return[!1,h+": "+m.date+" - "+e,""];if(!0===d.time&&!(!1===g&&f(a)||n.checkTime(a)))return[!1,h+": "+m.date+" - hh:mm (am/pm)",""];if(!(!0!==d.url||!1===g&&f(a)||(p=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,
p.test(a))))return[!1,h+": "+m.url,""];if(!0===d.custom){if(!1!==g||!f(a))return c.isFunction(d.custom_func)?(a=d.custom_func.call(this,a,h,b),c.isArray(a)?a:[!1,m.customarray,""]):[!1,m.customfcheck,""]}else if(c.isFunction(d.custom)&&(!1!==g||!f(a)))return a=d.custom.call(this,l),c.isArray(a)?a:[!1,m.customarray,""]}return[!0,"",""]}})});
//# sourceMappingURL=grid.common.map
